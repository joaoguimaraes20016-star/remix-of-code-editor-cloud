/**
 * Runtime-specific styles for EditorDocument rendering
 * 
 * These styles ensure published funnels render cleanly without any
 * editor-specific chrome (selection overlays, hover toolbars, etc.)
 * 
 * IMPORTANT: This is the ONLY CSS imported in runtime mode.
 * No editor CSS (canvas.css, canvas-experience.css) should be imported.
 */

/* ========================================
   Runtime Root Structure
   ======================================== */

/* Runtime wrapper - clean slate */
.builder-root[data-mode="runtime"] {
  width: 100%;
  min-height: 100vh;
}

.builder-root[data-mode="runtime"] .builder-canvas-frame {
  width: 100%;
  min-height: 100vh;
  background: transparent;
  /* Remove any editor frame styling */
  border: none;
  box-shadow: none;
  border-radius: 0;
}

.builder-root[data-mode="runtime"] .builder-page {
  width: 100%;
  min-height: 100vh;
}

/* ========================================
   Reset Editor Chrome
   ======================================== */

/* Reset all editor-specific behaviors in runtime */
.builder-v2-runtime .builder-v2-node {
  cursor: default !important;
  pointer-events: auto;
  /* Remove any editor-specific styling */
  outline: none !important;
  box-shadow: none;
}

.builder-v2-runtime .builder-v2-node--readonly {
  opacity: 1;
  pointer-events: auto;
}

/* Hide all editor overlays and toolbars */
.builder-v2-runtime .builder-v2-node-overlay,
.builder-v2-runtime .builder-v2-hover-toolbar,
.builder-v2-runtime .builder-v2-selection-ring,
.builder-v2-runtime .builder-v2-drop-indicator {
  display: none !important;
}

/* Remove selection states */
.builder-v2-runtime .builder-v2-node[data-selected='true'] .builder-v2-node-overlay,
.builder-v2-runtime .builder-v2-node:hover .builder-v2-node-overlay {
  display: none !important;
}

/* Remove focus mode fading */
.builder-v2-runtime .builder-v2-canvas:has(.builder-v2-node[data-selected='true']) .builder-v2-node:not([data-selected='true']) {
  opacity: 1;
  filter: none;
}

/* ========================================
   Full Width Content
   ======================================== */

/* Ensure full width content */
.builder-v2-runtime {
  width: 100%;
  min-height: 100%;
}

/* Node surface: inherit layout constraints from component/layout settings
   DO NOT force max-width:none - this breaks centered layouts */
.builder-v2-runtime .builder-v2-node-surface {
  width: 100%;
  /* Let component/layout settings control max-width and centering */
}

/* Frame primitives should be full-width in runtime */
.builder-v2-runtime [data-node-type="Frame"],
.builder-v2-runtime [data-node-type="Section"] {
  width: 100%;
}

/* Section content container */
.builder-v2-runtime .primitive-section {
  width: 100%;
  min-height: auto;
}

/* Hero sections should be at least viewport height */
.builder-v2-runtime .primitive-section--hero,
.builder-v2-runtime .primitive-section--hero-card {
  min-height: 100vh;
}

/* ========================================
   CRITICAL: Strip card styling from Hero in runtime
   The Hero component should inherit page background, not show dark card
   ======================================== */

.builder-v2-runtime .builder-v2-component--hero,
.builder-v2-runtime .builder-v2-component--hero-transparent {
  /* Remove card-frame styling */
  background: transparent !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  /* Let component define its own padding - don't force override */
  /* Inherit text color from context or use light */
  color: inherit;
}

/* Ensure hero content is still styled correctly */
.builder-v2-runtime .builder-v2-component--hero-headline {
  color: inherit;
  font-size: 26px;
  font-weight: 700;
  line-height: 1.2;
}

.builder-v2-runtime .builder-v2-component--hero-subheadline {
  color: inherit;
  opacity: 0.75;
  font-size: 16px;
  line-height: 1.5;
}

/* Forms should work in runtime */
.builder-v2-runtime input,
.builder-v2-runtime button,
.builder-v2-runtime select,
.builder-v2-runtime textarea {
  pointer-events: auto;
  cursor: auto;
}

.builder-v2-runtime button {
  cursor: pointer;
}

/* Ensure buttons are interactive */
.builder-v2-runtime .builder-v2-component--button,
.builder-v2-runtime .primitive-cta-button {
  pointer-events: auto;
  cursor: pointer;
  transition: transform 200ms ease, filter 200ms ease, box-shadow 200ms ease;
}

.builder-v2-runtime .builder-v2-component--button:hover,
.builder-v2-runtime .primitive-cta-button:hover {
  transform: translateY(-1px);
  filter: brightness(1.05);
}

.builder-v2-runtime .builder-v2-component--button:active,
.builder-v2-runtime .primitive-cta-button:active {
  transform: translateY(0);
}

/* Option grids should be interactive */
.builder-v2-runtime .primitive-option-card,
.builder-v2-runtime .builder-option-item {
  pointer-events: auto;
  cursor: pointer;
}

/* Selected option state */
.builder-v2-runtime .builder-option-item--selected {
  border-color: hsl(var(--primary)) !important;
  background-color: hsl(var(--primary) / 0.1) !important;
  box-shadow: 0 0 0 2px hsl(var(--primary) / 0.3);
}

/* Runtime node - clean wrapper */
.runtime-node {
  width: 100%;
}

/* Links should work */
.builder-v2-runtime a {
  pointer-events: auto;
  cursor: pointer;
}

/* Video embeds should be visible and interactive */
.builder-v2-runtime iframe,
.builder-v2-runtime video {
  pointer-events: auto;
}

/* Calendar embeds need to be interactive */
.builder-v2-runtime .primitive-calendar-embed iframe {
  pointer-events: auto;
}

/* Typography improvements for production */
.builder-v2-runtime .builder-v2-component--text,
.builder-v2-runtime .primitive-heading,
.builder-v2-runtime .primitive-paragraph {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

/* Form field styling */
.builder-v2-runtime .primitive-input {
  pointer-events: auto;
  transition: border-color 200ms ease, box-shadow 200ms ease;
}

.builder-v2-runtime .primitive-input:focus {
  outline: none;
  border-color: rgba(139, 92, 246, 0.5);
  box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
}

/* Consent checkbox */
.builder-v2-runtime .primitive-consent-checkbox {
  pointer-events: auto;
}

.builder-v2-runtime .primitive-consent-checkbox input[type="checkbox"] {
  cursor: pointer;
}

/* Remove any debug attributes styling */
.builder-v2-runtime [data-node-id],
.builder-v2-runtime [data-node-type] {
  /* Keep the attributes but don't style based on them */
}

/* Smooth scrolling for the page */
.builder-v2-runtime {
  scroll-behavior: smooth;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .builder-v2-runtime .builder-v2-node-surface {
    padding-left: 16px;
    padding-right: 16px;
  }
  
  .builder-v2-runtime .primitive-section {
    padding-left: 16px;
    padding-right: 16px;
  }
}

@media (max-width: 480px) {
  .builder-v2-runtime .builder-v2-node-surface {
    padding-left: 12px;
    padding-right: 12px;
  }
}

/* Animation optimizations */
.builder-v2-runtime * {
  will-change: auto;
}

/* Prefers reduced motion */
@media (prefers-reduced-motion: reduce) {
  .builder-v2-runtime * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ========================================
   FlowCanvas Runtime & Preview - Full-Bleed Parity
   Background is applied to viewport root,
   content is constrained by deviceWidths.
   
   CanvasRenderer is now used in readOnly mode
   to achieve pixel-perfect alignment parity.
   
   IMPORTANT: This CSS applies to BOTH:
   - .flowcanvas-runtime (published runtime)
   - .builder-v2-canvas--preview (editor draft/preview mode)
   ======================================== */

/* Runtime root - full-bleed background */
.flowcanvas-runtime,
.builder-v2-canvas--preview {
  /* Background applied via inline styles */
  min-height: 100vh;
  width: 100%;
}

/* Typography parity - match editor's font rendering */
.flowcanvas-runtime,
.flowcanvas-runtime *,
.builder-v2-canvas--preview,
.builder-v2-canvas--preview * {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

/* Primary color CSS variable usage */
.flowcanvas-runtime [style*='--primary-color'] {
  /* Allow --primary-color to be consumed by descendant elements */
}

/* Form elements in FlowCanvas runtime */
.flowcanvas-runtime input,
.flowcanvas-runtime select,
.flowcanvas-runtime textarea {
  font-family: inherit;
  background-color: hsl(var(--muted) / 0.5);
  border: 1px solid hsl(var(--border));
  color: inherit;
  transition: border-color 200ms ease, box-shadow 200ms ease;
}

.flowcanvas-runtime input:focus,
.flowcanvas-runtime select:focus,
.flowcanvas-runtime textarea:focus {
  outline: none;
  border-color: var(--primary-color, hsl(var(--primary)));
  box-shadow: 0 0 0 3px color-mix(in srgb, var(--primary-color, hsl(var(--primary))) 20%, transparent);
}

/* Button hover states in FlowCanvas - match editor preview */
.flowcanvas-runtime button:not(:disabled) {
  transition: transform 150ms ease, filter 150ms ease, box-shadow 150ms ease;
}

.flowcanvas-runtime button:not(:disabled):hover {
  filter: brightness(1.05);
}

.flowcanvas-runtime button:not(:disabled):active {
  transform: scale(0.98);
}

/* ========================================
   CRITICAL: Strip CanvasRenderer editor chrome in runtime/preview
   When CanvasRenderer is used with readOnly=true inside
   .flowcanvas-runtime OR .builder-v2-canvas--preview,
   we strip all editor-specific styling while preserving
   layout constraints for alignment parity.
   ======================================== */

/* Remove canvas grid background - make it transparent */
.flowcanvas-runtime .canvas-grid,
.builder-v2-canvas--preview .canvas-grid {
  background: transparent !important;
  /* Keep flex-1 and overflow behavior for layout */
}

/* Remove builder-scroll background */
.flowcanvas-runtime .builder-scroll,
.builder-v2-canvas--preview .builder-scroll {
  background: transparent !important;
}

/* CRITICAL: Device-frame becomes transparent in runtime/preview
   Background is already on .flowcanvas-runtime root (full-bleed)
   Device-frame should NOT add its own background or chrome */
.flowcanvas-runtime .device-frame,
.builder-v2-canvas--preview .device-frame {
  background: transparent !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  border: none !important;
}

/* Remove the pt-4 spacer in runtime (we have our own spacing) */
.flowcanvas-runtime .canvas-grid > .pt-4,
.builder-v2-canvas--preview .canvas-grid > .pt-4 {
  display: none !important;
}

/* The mx-auto px-8 pb-8 container from CanvasRenderer should NOT add centering
   It provides width constraints only - alignment comes from stack/element settings */
.flowcanvas-runtime .canvas-grid > div[class*="mx-auto"],
.builder-v2-canvas--preview .canvas-grid > div[class*="mx-auto"] {
  /* Keep max-width and horizontal padding for alignment parity */
  /* But remove any vertical padding that would interfere */
  padding-top: 0 !important;
  padding-bottom: 0 !important;
}

/* Hide section action bars and add-block buttons */
.flowcanvas-runtime .section-action-bar,
.flowcanvas-runtime .block-action-bar,
.flowcanvas-runtime .add-section-button,
.flowcanvas-runtime [class*="SectionActionBar"],
.flowcanvas-runtime [class*="BlockActionBar"],
.builder-v2-canvas--preview .section-action-bar,
.builder-v2-canvas--preview .block-action-bar,
.builder-v2-canvas--preview .add-section-button,
.builder-v2-canvas--preview [class*="SectionActionBar"],
.builder-v2-canvas--preview [class*="BlockActionBar"] {
  display: none !important;
}

/* Hide grid overlay that shows on hover */
.flowcanvas-runtime [style*="background-image: linear-gradient(to right"],
.builder-v2-canvas--preview [style*="background-image: linear-gradient(to right"] {
  display: none !important;
}

/* Hide section divider lines in runtime/preview */
.flowcanvas-runtime .bg-\[hsl\(var\(--builder-border-subtle\)\)\],
.builder-v2-canvas--preview .bg-\[hsl\(var\(--builder-border-subtle\)\)\] {
  display: none !important;
}

/* ========================================
   CRITICAL: Strip ALL editor chrome in runtime/preview
   Section/Block/Element outlines, badges, overlays, rings
   ======================================== */

/* Section-level chrome */
.flowcanvas-runtime .builder-section-selectable,
.builder-v2-canvas--preview .builder-section-selectable {
  cursor: default !important;
  outline: none !important;
}

.flowcanvas-runtime .builder-section-selectable:hover,
.builder-v2-canvas--preview .builder-section-selectable:hover {
  outline: none !important;
  box-shadow: none !important;
}

.flowcanvas-runtime .builder-section-selected,
.builder-v2-canvas--preview .builder-section-selected {
  outline: none !important;
  box-shadow: none !important;
}

.flowcanvas-runtime .builder-section-parent-of-selected,
.builder-v2-canvas--preview .builder-section-parent-of-selected {
  outline: none !important;
}

/* Block-level chrome */
.flowcanvas-runtime .builder-block-selectable,
.flowcanvas-runtime .builder-block-selectable:hover,
.builder-v2-canvas--preview .builder-block-selectable,
.builder-v2-canvas--preview .builder-block-selectable:hover {
  outline: none !important;
  box-shadow: none !important;
}

.flowcanvas-runtime .builder-block-selected,
.builder-v2-canvas--preview .builder-block-selected {
  outline: none !important;
  box-shadow: none !important;
}

.flowcanvas-runtime .builder-parent-of-selected,
.builder-v2-canvas--preview .builder-parent-of-selected {
  outline: none !important;
}

/* Element-level chrome */
.flowcanvas-runtime .builder-element-selectable,
.flowcanvas-runtime .builder-element-selectable:hover,
.builder-v2-canvas--preview .builder-element-selectable,
.builder-v2-canvas--preview .builder-element-selectable:hover {
  outline: none !important;
  box-shadow: none !important;
}

.flowcanvas-runtime .builder-element-selected,
.builder-v2-canvas--preview .builder-element-selected {
  outline: none !important;
  box-shadow: none !important;
}

/* Generic selected state */
.flowcanvas-runtime .builder-selected,
.builder-v2-canvas--preview .builder-selected {
  outline: none !important;
  box-shadow: none !important;
}

/* Hide ALL type badges (hero, section, block, etc.) */
.flowcanvas-runtime .block-type-badge,
.flowcanvas-runtime .section-type-badge,
.flowcanvas-runtime [class*="block-badge-"],
.flowcanvas-runtime [class*="block-type-badge-"],
.builder-v2-canvas--preview .block-type-badge,
.builder-v2-canvas--preview .section-type-badge,
.builder-v2-canvas--preview [class*="block-badge-"],
.builder-v2-canvas--preview [class*="block-type-badge-"] {
  display: none !important;
}

/* Hide V2 node overlays (hover/selection rings) */
.flowcanvas-runtime .builder-v2-node-overlay,
.builder-v2-canvas--preview .builder-v2-node-overlay {
  display: none !important;
}

.flowcanvas-runtime .builder-v2-node:hover .builder-v2-node-overlay,
.flowcanvas-runtime .builder-v2-node[data-selected='true'] .builder-v2-node-overlay,
.builder-v2-canvas--preview .builder-v2-node:hover .builder-v2-node-overlay,
.builder-v2-canvas--preview .builder-v2-node[data-selected='true'] .builder-v2-node-overlay {
  display: none !important;
}

/* Step-card editor chrome (border-radius, shadows for "scene" effect) */
.flowcanvas-runtime .step-card,
.builder-v2-canvas--preview .step-card {
  border-radius: 0 !important;
  box-shadow: none !important;
}

/* Make bg-canvas-bg transparent */
.flowcanvas-runtime .bg-canvas-bg,
.builder-v2-canvas--preview .bg-canvas-bg {
  background: transparent !important;
}

/* Ensure dark-theme class on device-frame doesn't add dark background */
.flowcanvas-runtime .device-frame.dark-theme,
.builder-v2-canvas--preview .device-frame.dark-theme {
  background: transparent !important;
}

/* Hide any drag handles or resize grips */
.flowcanvas-runtime [class*="drag-handle"],
.flowcanvas-runtime [class*="resize-grip"],
.builder-v2-canvas--preview [class*="drag-handle"],
.builder-v2-canvas--preview [class*="resize-grip"] {
  display: none !important;
}

/* Hide selection rings that use ring-* utilities */
.flowcanvas-runtime [class*="ring-selection"],
.flowcanvas-runtime [class*="ring-primary"],
.builder-v2-canvas--preview [class*="ring-selection"],
.builder-v2-canvas--preview [class*="ring-primary"] {
  --tw-ring-opacity: 0 !important;
  --tw-ring-color: transparent !important;
}

/* ========================================
   ADDITIONAL: Catch-all hover outline disabling
   ======================================== */

/* Disable ALL hover outlines within preview/runtime - global reset */
.flowcanvas-runtime *:hover,
.builder-v2-canvas--preview *:hover {
  outline-color: transparent !important;
}

/* Disable pointer-events on chrome overlays but allow content interaction */
.flowcanvas-runtime .builder-click-target,
.builder-v2-canvas--preview .builder-click-target {
  cursor: default !important;
}

/* Group hover states - common pattern in builder */
.flowcanvas-runtime .group:hover .group-hover\:ring-2,
.flowcanvas-runtime .group:hover .group-hover\:ring-white\/20,
.flowcanvas-runtime .group\/element:hover,
.flowcanvas-runtime .group\/block:hover,
.flowcanvas-runtime .group\/section:hover,
.builder-v2-canvas--preview .group:hover .group-hover\:ring-2,
.builder-v2-canvas--preview .group:hover .group-hover\:ring-white\/20,
.builder-v2-canvas--preview .group\/element:hover,
.builder-v2-canvas--preview .group\/block:hover,
.builder-v2-canvas--preview .group\/section:hover {
  --tw-ring-opacity: 0 !important;
  outline: none !important;
}

/* Disable any element with builder prefix from showing outlines on hover */
.flowcanvas-runtime [class*="builder-"]:hover,
.builder-v2-canvas--preview [class*="builder-"]:hover {
  outline: none !important;
  box-shadow: none !important;
}

/* Hero block specific hover states */
.flowcanvas-runtime .block-type-hero:hover,
.flowcanvas-runtime [data-block-type="hero"]:hover,
.builder-v2-canvas--preview .block-type-hero:hover,
.builder-v2-canvas--preview [data-block-type="hero"]:hover {
  outline: none !important;
}

/* Frame/section wrappers */
.flowcanvas-runtime .frame-wrapper:hover,
.flowcanvas-runtime .section-wrapper:hover,
.builder-v2-canvas--preview .frame-wrapper:hover,
.builder-v2-canvas--preview .section-wrapper:hover {
  outline: none !important;
  box-shadow: none !important;
}

/* StepPreview hover rings (from StepPreview.tsx) */
.flowcanvas-runtime .hover\:ring-2:hover,
.flowcanvas-runtime .hover\:ring-primary\/50:hover,
.builder-v2-canvas--preview .hover\:ring-2:hover,
.builder-v2-canvas--preview .hover\:ring-primary\/50:hover {
  --tw-ring-opacity: 0 !important;
  --tw-ring-color: transparent !important;
}

/* Canvas grid background - hide in preview */
.builder-v2-canvas--preview.canvas-grid {
  background: transparent !important;
}
